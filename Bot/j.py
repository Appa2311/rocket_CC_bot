import base64
exec(base64.b64decode("ZnJvbSB0ZWxlYm90IGltcG9ydCBUZWxlQm90CmltcG9ydCBvcwpmcm9tIGNyZWQgaW1wb3J0ICoKaW1wb3J0IGpzb24KZGVmIGxvYWRfZnJlZV91c2VycygpOgogICAgaWYgb3MucGF0aC5leGlzdHMoRlJFRV9VU0VSU19GSUxFKSBhbmQgb3MucGF0aC5nZXRzaXplKEZSRUVfVVNFUlNfRklMRSkgPiAwOgogICAgICAgIHdpdGggb3BlbihGUkVFX1VTRVJTX0ZJTEUsICJyIikgYXMgZmlsZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmV0dXJuIGpzb24ubG9hZChmaWxlKQogICAgICAgICAgICBleGNlcHQganNvbi5KU09ORGVjb2RlRXJyb3I6CiAgICAgICAgICAgICAgICByZXR1cm4ge30gICMgSWYgSlNPTiBpcyBjb3JydXB0ZWQsIHJldHVybiBhbiBlbXB0eSBkaWN0aW9uYXJ5CiAgICByZXR1cm4ge30gICMgSWYgZmlsZSBkb2Vzbid0IGV4aXN0IG9yIGlzIGVtcHR5LCByZXR1cm4gYW4gZW1wdHkgZGljdGlvbmFyeQpmcmVlX3VzZXJzPSBsb2FkX2ZyZWVfdXNlcnMoKQpkZWYgYWRtaW4oYm90OiBUZWxlQm90KToKICAgIEBib3QubWVzc2FnZV9oYW5kbGVyKGNvbW1hbmRzPVsnc3RhdHMnXSkKICAgIGRlZiBzampzanMobWVzc2FnZSk6CiAgICAgICAgaWYgc3RyKG1lc3NhZ2UuZnJvbV91c2VyLmlkKSBub3QgaW4gZnJlZV91c2VyczoKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsZiJIZXkgeW91IGFyZSBub3QgcmVnaXN0ZXJlZC4gUGxlYXNlIHJlZ2lzdGVyIHVzaW5nIC9yZWdpc3RlciBjbWQu4pyFIikKICAgICAgICAgICAgcmV0dXJuIAogICAgICAgIGlmIHN0cihtZXNzYWdlLmZyb21fdXNlci5pZCkgbm90IGluIGFkbWluOgogICAgICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSwgIvCfmqsgWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byB1c2UgdGhpcyBjb21tYW5kLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGRhdGEgPWZvcm1hdF9zZXJ2ZXJfbWVzc2FnZSgpCiAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsZGF0YSxwYXJzZV9tb2RlPSJIVE1MIikKICAgIEBib3QubWVzc2FnZV9oYW5kbGVyKGNvbW1hbmRzPVsnYWRtaW4nXSkKICAgIGRlZiBhZG1pbl9jb21tYW5kKG1lc3NhZ2UpOgogICAgICAgIAogICAgICAgIGlmIHN0cihtZXNzYWdlLmZyb21fdXNlci5pZCkgbm90IGluIGZyZWVfdXNlcnM6CiAgICAgICAgICAgIGJvdC5yZXBseV90byhtZXNzYWdlLGYiSGV5IHlvdSBhcmUgbm90IHJlZ2lzdGVyZWQuIFBsZWFzZSByZWdpc3RlciB1c2luZyAvcmVnaXN0ZXIgY21kLuKchSIpCiAgICAgICAgICAgIHJldHVybiAKICAgICAgICBpZiBzdHIobWVzc2FnZS5mcm9tX3VzZXIuaWQpIG5vdCBpbiBhZG1pbjoKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsICLinYwgWW91IGFyZSBub3QgYW4gYWRtaW4hIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsIGYiIiLwn5SRIEFkbWluIENvbW1hbmRzIChBZG1pbnMgT25seSkKICAgIAogICAgL2FkbWluIC0g8J+boO+4jyBBY2Nlc3MgYWRtaW4gZmVhdHVyZXMKICAgIC9icm9hZGNhc3QgPG1lc3NhZ2U+IC0g8J+ToiBTZW5kIGEgbWVzc2FnZSB0byBhbGwgdXNlcnMKICAgIC9jb2RlIDxxdHk+IDxjcmVkaXRzPiAtIPCfjp/vuI8gR2VuZXJhdGUgcmVkZWVtYWJsZSBjb2RlcwogICAgL2RiIC0g8J+TiiBWaWV3IGJvdCBkYXRhYmFzZSBzdGF0aXN0aWNzCiAgICDwn5OKIFNlcnZlciAmIE5ldHdvcmsgVG9vbHMKICAgIC9zdGF0cyAtIPCfk4ggU2VydmVyIG1vbml0b3Jpbmcgc3RhdHMKICAgIC9waW5nIC0g8J+ToSBDaGVjayBuZXR3b3JrIGxhdGVuY3kiIiIpCiAgICAgICAgCiAgICAKICAgIEBib3QubWVzc2FnZV9oYW5kbGVyKGNvbW1hbmRzPVsncGluZyddKQogICAgZGVmIG8obWVzc2FnZSk6CiAgICAgICAgCiAgICAgICAgaWYgc3RyKG1lc3NhZ2UuZnJvbV91c2VyLmlkKSBub3QgaW4gZnJlZV91c2VyczoKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsZiJIZXkgeW91IGFyZSBub3QgcmVnaXN0ZXJlZC4gUGxlYXNlIHJlZ2lzdGVyIHVzaW5nIC9yZWdpc3RlciBjbWQu4pyFIikKICAgICAgICAgICAgcmV0dXJuIAogICAgICAgIGlmIHN0cihtZXNzYWdlLmZyb21fdXNlci5pZCkgbm90IGluIGFkbWluOgogICAgICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSwgIvCfmqsgWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byB1c2UgdGhpcyBjb21tYW5kLiIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIGNtZF9waW5nKGJvdCwgbWVzc2FnZSkKICAgIEBib3QubWVzc2FnZV9oYW5kbGVyKGNvbW1hbmRzPVsnYWRkJ10pCiAgICBkZWYgYWRkX2NyZWRpdChtZXNzYWdlKToKICAgICAgICBpZiBzdHIobWVzc2FnZS5mcm9tX3VzZXIuaWQpIG5vdCBpbiBmcmVlX3VzZXJzOgogICAgICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSxmIkhleSB5b3UgYXJlIG5vdCByZWdpc3RlcmVkLiBQbGVhc2UgcmVnaXN0ZXIgdXNpbmcgL3JlZ2lzdGVyIGNtZC7inIUiKQogICAgICAgICAgICByZXR1cm4gCiAgICAgICAgYWRtaW5faWQgPSBtZXNzYWdlLmZyb21fdXNlci5pZAogICAgICAgIGlmIHN0cihhZG1pbl9pZCkgbm90IGluIGFkbWluOiAgIyBSZXBsYWNlIEFETUlOX0lEUyB3aXRoIGEgbGlzdCBvZiBhZG1pbiBUZWxlZ3JhbSBJRHMKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsICLwn5qrIFlvdSBhcmUgbm90IGF1dGhvcml6ZWQgdG8gdXNlIHRoaXMgY29tbWFuZC4iKQogICAgICAgICAgICByZXR1cm4KICAgIAogICAgICAgIHRyeToKICAgICAgICAgICAgY29tbWFuZF9wYXJ0cyA9IG1lc3NhZ2UudGV4dC5zcGxpdCgpCiAgICAgICAgICAgIGlmIGxlbihjb21tYW5kX3BhcnRzKSAhPSAzOgogICAgICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsICLimqDvuI8gVXNhZ2U6IC9hZGRjcmVkaXQgPHVzZXJfaWQ+IDxhbW91bnQ+IikKICAgICAgICAgICAgICAgIHJldHVybgogICAgCiAgICAgICAgICAgIHVzZXJfaWQgPSBpbnQoY29tbWFuZF9wYXJ0c1sxXSkKICAgICAgICAgICAgYW1vdW50ID0gaW50KGNvbW1hbmRfcGFydHNbMl0pCiAgICAKICAgICAgICAgICAgIyBMb2FkIHVzZXIgZGF0YQogICAgICAgICAgICB3aXRoIG9wZW4oImZyZWVfdXNlcnMuanNvbiIsICJyIikgYXMgZmlsZToKICAgICAgICAgICAgICAgIHVzZXJzID0ganNvbi5sb2FkKGZpbGUpCiAgICAKICAgICAgICAgICAgIyBVcGRhdGUgdXNlcidzIGJhbGFuY2UKICAgICAgICAgICAgaWYgc3RyKHVzZXJfaWQpIGluIHVzZXJzOgogICAgICAgICAgICAgICAgdXNlcnNbc3RyKHVzZXJfaWQpXVsncG9pbnRzJ10gKz0gYW1vdW50CiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB1c2Vyc1tzdHIodXNlcl9pZCldID0geydwb2ludHMnOiBhbW91bnR9CiAgICAKICAgICAgICAgICAgIyBTYXZlIHVwZGF0ZWQgZGF0YQogICAgICAgICAgICB3aXRoIG9wZW4oImZyZWVfdXNlcnMuanNvbiIsICJ3IikgYXMgZmlsZToKICAgICAgICAgICAgICAgIGpzb24uZHVtcCh1c2VycywgZmlsZSwgaW5kZW50PTQpCiAgICAKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsIGYi4pyFIFN1Y2Nlc3NmdWxseSBhZGRlZCB7YW1vdW50fSBwb2ludHMgdG8gdXNlciB7dXNlcl9pZH0uIikKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsICLimqDvuI8gSW52YWxpZCBpbnB1dC4gTWFrZSBzdXJlIHRvIGVudGVyIG51bWJlcnMgb25seS4iKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsIGYi4p2MIEVycm9yOiB7c3RyKGUpfSIp").decode())