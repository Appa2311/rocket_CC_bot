import base64
exec(base64.b64decode("ZnJvbSB0ZWxlYm90IGltcG9ydCBUZWxlQm90CmZyb20gY3JlZCBpbXBvcnQgKgppbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHRpbWUKCiMg8J+TgiBGdW5jdGlvbiB0byBsb2FkIGZyZWUgdXNlcnMKZGVmIGxvYWRfZnJlZV91c2VycygpOgogICAgaWYgb3MucGF0aC5leGlzdHMoRlJFRV9VU0VSU19GSUxFKSBhbmQgb3MucGF0aC5nZXRzaXplKEZSRUVfVVNFUlNfRklMRSkgPiAwOgogICAgICAgIHdpdGggb3BlbihGUkVFX1VTRVJTX0ZJTEUsICJyIikgYXMgZmlsZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcmV0dXJuIGpzb24ubG9hZChmaWxlKQogICAgICAgICAgICBleGNlcHQganNvbi5KU09ORGVjb2RlRXJyb3I6CiAgICAgICAgICAgICAgICByZXR1cm4ge30gICMgUmV0dXJuIGVtcHR5IGRpY3Rpb25hcnkgaWYgSlNPTiBpcyBjb3JydXB0ZWQKICAgIHJldHVybiB7fSAgIyBSZXR1cm4gZW1wdHkgZGljdGlvbmFyeSBpZiBmaWxlIGRvZXNuJ3QgZXhpc3QKCiMg8J+TgiBGdW5jdGlvbiB0byBzYXZlIGZyZWUgdXNlcnMKZGVmIHNhdmVfZnJlZV91c2Vycyh1c2Vycyk6CiAgICB3aXRoIG9wZW4oRlJFRV9VU0VSU19GSUxFLCAidyIpIGFzIGZpbGU6CiAgICAgICAganNvbi5kdW1wKHVzZXJzLCBmaWxlLCBpbmRlbnQ9NCkKCiMg8J+OmyBNYWluIHRvb2xzIGZ1bmN0aW9uIGZvciB0aGUgYm90CmRlZiB0b29scyhib3Q6IFRlbGVCb3QpOgogICAgCiAgICBAYm90Lm1lc3NhZ2VfaGFuZGxlcihjb21tYW5kcz1bJ2dlbiddKQogICAgZGVmIGdhdGVzKG1lc3NhZ2UpOgogICAgICAgIGZyZWVfdXNlcnMgPSBsb2FkX2ZyZWVfdXNlcnMoKSAgIyBBbHdheXMgbG9hZCBsYXRlc3QgdXNlcnMKICAgICAgICBpZiBzdHIobWVzc2FnZS5mcm9tX3VzZXIuaWQpIG5vdCBpbiBmcmVlX3VzZXJzOgogICAgICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSwgIkhleSwgeW91IGFyZSBub3QgcmVnaXN0ZXJlZC4gUGxlYXNlIHJlZ2lzdGVyIHVzaW5nIC9yZWdpc3RlciDinIUiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICBzdGFydF90aW1lID0gdGltZS5wZXJmX2NvdW50ZXIoKQogICAgICAgIGNoYXRfaWQgPSBtZXNzYWdlLmZyb21fdXNlci5pZAogICAgICAgIGFyZ3MgPSBtZXNzYWdlLnRleHQuc3BsaXQoKVsxOl0KICAgICAgICBpZiBsZW4oYXJncykgIT0gMToKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsICIiIuKdjCBJbnZhbGlkIEZvcm1hdCEgVXNlOgogICAgPGNvZGU+L2dlbiA0NDc2OTd8MTJ8MjV8MTIzPC9jb2RlPiBvciA8Y29kZT4vZ2VuIDEyMzQ1NjwvY29kZT4iIiIsIHBhcnNlX21vZGU9IkhUTUwiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGlmIG5vdCBvcChtZXNzYWdlLmZyb21fdXNlci5pZCk6CiAgICAgICAgICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSwgIllvdSBkb24ndCBoYXZlIGVub3VnaCBjcmVkaXQuIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGJpbl9pbnB1dCA9IGFyZ3NbMF0KICAgICAgICAgICAgICAgIGRhdGEgPSBnZXRfYmluKGJpbl9pbnB1dCkgb3Ige30KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgYmFuayA9IGRhdGEuZ2V0KCJiYW5rIiwgIk4vQSIpCiAgICAgICAgICAgICAgICBjb3VudHJ5ID0gZGF0YS5nZXQoImNvdW50cnkiLCAiTi9BIikKICAgICAgICAgICAgICAgIHNjaGVtZSA9IGRhdGEuZ2V0KCJzY2hlbWUiLCAiTi9BIikKICAgICAgICAgICAgICAgIGxldmVsID0gZGF0YS5nZXQoImxldmVsIiwgIk4vQSIpCiAgICAgICAgICAgICAgICB0eXBlXyA9IGRhdGEuZ2V0KCJ0eXBlIiwgIk4vQSIpCgogICAgICAgICAgICAgICAgZ2VuZXJhdGVkX2NhcmRzID0gZ2VuKGJpbl9pbnB1dCkKICAgICAgICAgICAgICAgIGVuZF90aW1lID0gdGltZS5wZXJmX2NvdW50ZXIoKQogICAgICAgICAgICAgICAgZXhlY3V0aW9uX3RpbWUgPSBlbmRfdGltZSAtIHN0YXJ0X3RpbWUKCiAgICAgICAgICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSwgZiIiIuKchSDwnZCC8J2QgiDwnZCG8J2QnvCdkKfwnZCe8J2Qq/CdkJrwnZCt8J2QnvCdkJ0g8J2QkvCdkK7wnZCc8J2QnPCdkJ7wnZCs8J2QrPCdkJ/wnZCu8J2QpfCdkKXwnZCyICAKICAgICAgICAgICAgCvCflKIg8J2QgfCdkKLwnZCnOiB7YmluX2lucHV0fSAgCvCflKIg8J2QgPCdkKbwnZCo8J2QrvCdkKfwnZCtOiAxMCAgCiAgICAgICAgICAgIAp7Z2VuZXJhdGVkX2NhcmRzfQogICAgICAgICAgICAK4oS577iPIHtzY2hlbWV9IC0ge2xldmVsfSAgCvCfj5sg8J2QgfCdkJrwnZCn8J2QpDoge2Jhbmt9ICAK8J+HuvCfh7gg8J2QgvCdkKjwnZCu8J2Qp/CdkK3wnZCr8J2Qsjoge2NvdW50cnl9ICAKICAgICAgICAgICAgCuKPsyDwnZCT8J2QovCdkKbwnZCeOiB7ZXhlY3V0aW9uX3RpbWU6LjJmfSBzZWNvbmRzCiAgICAgICAgICAgIArwn5GkIENoZWNrZWQgYnkgQHttZXNzYWdlLmZyb21fdXNlci51c2VybmFtZX0g8J+agCIiIiwgcGFyc2VfbW9kZT0iSFRNTCIpCgogICAgQGJvdC5tZXNzYWdlX2hhbmRsZXIoY29tbWFuZHM9WydyZWdpc3RlciddKQogICAgZGVmIHJlZ2lzdGVyKG1lc3NhZ2UpOgogICAgICAgIGZyZWVfdXNlcnMgPSBsb2FkX2ZyZWVfdXNlcnMoKSAgIyBBbHdheXMgbG9hZCBsYXRlc3QgdXNlcnMKICAgICAgICBjaGF0X2lkID0gc3RyKG1lc3NhZ2UuZnJvbV91c2VyLmlkKQoKICAgICAgICBpZiBjaGF0X2lkIGluIGZyZWVfdXNlcnM6CiAgICAgICAgICAgIGJvdC5yZXBseV90byhtZXNzYWdlLCBmIlVzZXIge2NoYXRfaWR9IGFscmVhZHkgZXhpc3RzIHdpdGgge2ZyZWVfdXNlcnNbY2hhdF9pZF1bJ2NyZWRpdHMnXX0gY3JlZGl0cy4iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGZyZWVfdXNlcnNbY2hhdF9pZF0gPSB7ImNyZWRpdHMiOiA1MH0KICAgICAgICAgICAgc2F2ZV9mcmVlX3VzZXJzKGZyZWVfdXNlcnMpCiAgICAgICAgICAgIGJvdC5yZXBseV90byhtZXNzYWdlLCBmIlJlZ2lzdHJhdGlvbiBjb21wbGV0ZWQu4pyFXG5cblVzZXIge2NoYXRfaWR9IGFkZGVkIHdpdGggNTAgZnJlZSBjcmVkaXRzLiIpCgogICAgQGJvdC5tZXNzYWdlX2hhbmRsZXIoY29tbWFuZHM9WydjcmVkaXQnLCAnY3JlZGl0cyddKQogICAgZGVmIGNyZWRpdChtZXNzYWdlKToKICAgICAgICBmcmVlX3VzZXJzID0gbG9hZF9mcmVlX3VzZXJzKCkgICMgQWx3YXlzIGxvYWQgbGF0ZXN0IHVzZXJzCiAgICAgICAgY2hhdF9pZCA9IHN0cihtZXNzYWdlLmZyb21fdXNlci5pZCkKCiAgICAgICAgaWYgY2hhdF9pZCBub3QgaW4gZnJlZV91c2VyczoKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsICJIZXksIHlvdSBhcmUgbm90IHJlZ2lzdGVyZWQuIFBsZWFzZSByZWdpc3RlciB1c2luZyAvcmVnaXN0ZXIg4pyFIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgCiAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsIGYi8J+SsCBZb3UgaGF2ZSB7ZnJlZV91c2Vyc1tjaGF0X2lkXVsnY3JlZGl0cyddfSBjcmVkaXRzIOKchSIpCgogICAgQGJvdC5tZXNzYWdlX2hhbmRsZXIoY29tbWFuZHM9WydpbmZvJ10pCiAgICBkZWYgdXNlcl9pbmZvX2NvbW1hbmQobWVzc2FnZSk6CiAgICAgICAgZnJlZV91c2VycyA9IGxvYWRfZnJlZV91c2VycygpICAjIEFsd2F5cyBsb2FkIGxhdGVzdCB1c2VycwogICAgICAgIGlmIHN0cihtZXNzYWdlLmZyb21fdXNlci5pZCkgbm90IGluIGZyZWVfdXNlcnM6CiAgICAgICAgICAgIGJvdC5yZXBseV90byhtZXNzYWdlLCAiSGV5LCB5b3UgYXJlIG5vdCByZWdpc3RlcmVkLiBQbGVhc2UgcmVnaXN0ZXIgdXNpbmcgL3JlZ2lzdGVyIOKchSIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHVzZXJfaW5mbyhib3QsIG1lc3NhZ2UpCgogICAgQGJvdC5tZXNzYWdlX2hhbmRsZXIoY29tbWFuZHM9WydiaW4nXSkKICAgIGRlZiBiaW5faW5mb19jb21tYW5kKG1lc3NhZ2UpOgogICAgICAgIGZyZWVfdXNlcnMgPSBsb2FkX2ZyZWVfdXNlcnMoKSAgIyBBbHdheXMgbG9hZCBsYXRlc3QgdXNlcnMKICAgICAgICBpZiBzdHIobWVzc2FnZS5mcm9tX3VzZXIuaWQpIG5vdCBpbiBmcmVlX3VzZXJzOgogICAgICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSwgIkhleSwgeW91IGFyZSBub3QgcmVnaXN0ZXJlZC4gUGxlYXNlIHJlZ2lzdGVyIHVzaW5nIC9yZWdpc3RlciDinIUiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICBnZXRfYmluX2luZm8oYm90LCBtZXNzYWdlKQoKICAgIEBib3QubWVzc2FnZV9oYW5kbGVyKGNvbW1hbmRzPVsnc2snXSkKICAgIGRlZiBjaGVja19zayhtZXNzYWdlKToKICAgICAgICBmcmVlX3VzZXJzID0gbG9hZF9mcmVlX3VzZXJzKCkgICMgQWx3YXlzIGxvYWQgbGF0ZXN0IHVzZXJzCiAgICAgICAgY2hhdF9pZCA9IG1lc3NhZ2UuZnJvbV91c2VyLmlkCiAgICAgICAgYXJncyA9IG1lc3NhZ2UudGV4dC5zcGxpdCgiICIsIDEpCgogICAgICAgIGlmIGxlbihhcmdzKSA8IDIgb3Igbm90IGFyZ3NbMV0uc3RhcnRzd2l0aCgic2tfbGl2ZV8iKToKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsICLinYwgKipVc2FnZToqKiBgL3NrIHNrX2xpdmVfeHh4YFxuUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBTdHJpcGUgU2VjcmV0IEtleS4iLCBwYXJzZV9tb2RlPSJNYXJrZG93biIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBzdHIoY2hhdF9pZCkgbm90IGluIGZyZWVfdXNlcnM6CiAgICAgICAgICAgIGJvdC5yZXBseV90byhtZXNzYWdlLCAiSGV5LCB5b3UgYXJlIG5vdCByZWdpc3RlcmVkLiBQbGVhc2UgcmVnaXN0ZXIgdXNpbmcgL3JlZ2lzdGVyIOKchSIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgIHNrX2tleSA9IGFyZ3NbMV0uc3RyaXAoKQogICAgICAgIGlmIG5vdCBvcChjaGF0X2lkKToKICAgICAgICAgICAgYm90LnJlcGx5X3RvKG1lc3NhZ2UsICJZb3UgZG9uJ3QgaGF2ZSBlbm91Z2ggY3JlZGl0LiIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmVzdWx0ID0gc2soc2tfa2V5KQogICAgICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSwgcmVzdWx0LCBwYXJzZV9tb2RlPSJIVE1MIikKCiAgICBAYm90Lm1lc3NhZ2VfaGFuZGxlcihjb21tYW5kcz1bJ2dhdGVzJywgJ2dhdGUnXSkKICAgIGRlZiBnYXRlX2luZm8obWVzc2FnZSk6CiAgICAgICAgZnJlZV91c2VycyA9IGxvYWRfZnJlZV91c2VycygpICAjIEFsd2F5cyBsb2FkIGxhdGVzdCB1c2VycwogICAgICAgIGlmIHN0cihtZXNzYWdlLmZyb21fdXNlci5pZCkgbm90IGluIGZyZWVfdXNlcnM6CiAgICAgICAgICAgIGJvdC5yZXBseV90byhtZXNzYWdlLCAiSGV5LCB5b3UgYXJlIG5vdCByZWdpc3RlcmVkLiBQbGVhc2UgcmVnaXN0ZXIgdXNpbmcgL3JlZ2lzdGVyIOKchSIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgIGJvdC5yZXBseV90byhtZXNzYWdlLCAiIiLwn5KzIFBheW1lbnQgQ2hlY2tlcnMgKEdhdGVzKQogICAgCi9nYXRlIC0g8J+UkSBMaXN0IGFsbCBhdmFpbGFibGUgZ2F0ZXMKL2NoayA8Y2N8bW18eXl8Y3Z2PiAtIOKchSBDaGVjayBTdHJpcGUgY2FyZCB2YWxpZGl0eQovYiAtIPCflJAgQnJhaW50cmVlIChQcmVtaXVtKSIiIikKCiAgICBAYm90Lm1lc3NhZ2VfaGFuZGxlcihjb21tYW5kcz1bJ3Rvb2xzJywgJ3Rvb2wnXSkKICAgIGRlZiB0b29sc19pbmZvKG1lc3NhZ2UpOgogICAgICAgIGZyZWVfdXNlcnMgPSBsb2FkX2ZyZWVfdXNlcnMoKSAgIyBBbHdheXMgbG9hZCBsYXRlc3QgdXNlcnMKICAgICAgICBpZiBzdHIobWVzc2FnZS5mcm9tX3VzZXIuaWQpIG5vdCBpbiBmcmVlX3VzZXJzOgogICAgICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSwgIkhleSwgeW91IGFyZSBub3QgcmVnaXN0ZXJlZC4gUGxlYXNlIHJlZ2lzdGVyIHVzaW5nIC9yZWdpc3RlciDinIUiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAKICAgICAgICBib3QucmVwbHlfdG8obWVzc2FnZSwgIiIi8J+UpyBVc2VmdWwgVG9vbHMKICAgIAovYmluIGJpbl9udW1iZXIgLSDwn4+mIEdldCBCSU4gaW5mb3JtYXRpb24KL2dlbiBiaW4gLSDwn5SEIEdlbmVyYXRlIGNyZWRpdCBjYXJkcyBmcm9tIEJJTgovaW5mbyAtIOKEue+4jyBHZXQgdXNlciBpbmZvcm1hdGlvbgovZmFrZSAtIPCfg48gR2VuZXJhdGUgZmFrZSB1c2VyIGRldGFpbHMKL2NvdW50cnljb2RlIC0g8J+MjSBHZXQgY291bnRyeSBjb2Rlcwovc2sgc2tfbGl2ZV94eHggLSDwn5SNIFZhbGlkYXRlIGEgU3RyaXBlIFNlY3JldCBLZXkiIiIsIHBhcnNlX21vZGU9IkhUTUwiKQ==").decode())